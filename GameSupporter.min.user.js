// ==UserScript==
// @name		GameSupporter
// @version		2025.08.13
// @author		leo7044
// @homepage		https://rapidly-decent-spider.ngrok-free.app/leoGameStats/
// @downloadURL		https://github.com/leo7044/CnC_TA/raw/master/GameSupporter.min.user.js
// @updateURL		https://github.com/leo7044/CnC_TA/raw/master/GameSupporter.min.user.js
// @description		Base verlegen, Support setzen
// @include		http*://cncapp*.alliances.commandandconquer.com/*/index.aspx*
// @icon		data:image/png;base64,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
// @grant		none
// ==/UserScript==

!function(){var e;"/login/auth"!=window.location.pathname&&((e=document.createElement("script")).innerHTML="("+function(){function n(){var t,e;GameSupporter.InstanceId=ClientLib.Net.CommunicationManager.GetInstance().get_InstanceId(),null==GameSupporter.InstanceId&&1<=GameSupporter.OfflineCounter?((t=new XMLHttpRequest).onreadystatechange=function(){var e;4==this.readyState&&200==this.status&&(e=Date.parse(JSON.parse(t.response)[0].LastUsed),Date.parse(new Date)+(new Date).getTimezoneOffset()/60*36e5-e<=1e4?fetch("https://cncapp"+GameSupporter.HostId+".alliances.commandandconquer.com/"+GameSupporter.WorldId+"/Presentation/Service.svc/ajaxEndpoint/OpenSession",{headers:{"content-type":"application/json"},body:'{"session":"'+GameSupporter.SessionId+'","reset":true,"refId":-1,"version":-1,"platformId":'+GameSupporter.PlatformId+"}",method:"POST"}).then(function(e){e.json().then(function(e){ClientLib.Net.CommunicationManager.GetInstance().set_InstanceId(e.i)})}):clearInterval(GameSupporter.CheckInterval))},(e=new FormData).append("action","getLastUsed"),e.append("PlayerName",GameSupporter.PlayerName),t.open("POST","https://www.leo7044.lima-city.de/php/manageBackend.php",!0),t.send(e),GameSupporter.OfflineCounter=0):null==GameSupporter.InstanceId&&GameSupporter.OfflineCounter++}function a(){qx.Class.define("GameSupporter",{type:"singleton",extend:qx.core.Object,construct:function(){console.log("create GameSupporter...")},members:{initialize:function(){var e,t;0<ClientLib.Data.MainData.GetInstance().get_Player().get_Id()?ClientLib.Data.MainData.GetInstance().get_Player().get_IsSubstituted()||(GameSupporter.OfflineCounter=0,GameSupporter.PlayerName=ClientLib.Data.MainData.GetInstance().get_Player().get_Name(),GameSupporter.SessionId=ClientLib.Net.CommunicationManager.GetInstance().get_SessionId(),GameSupporter.PlatformId=ClientLib.Net.CommunicationManager.GetInstance().get_PlatformId(),GameSupporter.HostId=document.URL.split("/")[2].split(".")[0].substr(-2),GameSupporter.WorldId=ClientLib.Data.MainData.GetInstance().get_Server().get_WorldId(),e=new XMLHttpRequest,(t=new FormData).append("action","sendSessionId"),t.append("SessionId",GameSupporter.SessionId),t.append("PlayerName",GameSupporter.PlayerName),e.open("POST","https://www.leo7044.lima-city.de/php/manageBackend.php",!0),e.send(t),GameSupporter.CheckInterval=setInterval(n,1e3)):setTimeout(a,1e3)}}}),GameSupporter.getInstance().initialize()}!function e(){try{if("undefined"!=typeof qx&&qx.core.Init.getApplication().getMenuBar())return void a()}catch(e){void 0!==console?console.log(e):window.opera?opera.postError(e):GM_log(e)}window.setTimeout(e,1e3)}()}.toString()+")();",e.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(e))}();
